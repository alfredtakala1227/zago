!function(root,factory){"use strict";"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?module.exports=factory():root.viewportUnitsBuggyfillHacks=factory()}(this,function(){"use strict";var options,calcExpression=/calc\(/g,quoteExpression=/[\"\']/g,isOldInternetExplorer=!1,supportsVminmax=!0,supportsVminmaxCalc=!0;function checkHacks(declarations,rule,name,value){var needsHack="content"===name&&value.indexOf("viewport-units-buggyfill")>-1;if(needsHack){var fakeRules=value.replace(quoteExpression,"");fakeRules.split(";").forEach(function(fakeRuleElement){var fakeRule=fakeRuleElement.split(":");if(2===fakeRule.length){var name=fakeRule[0].trim();if("viewport-units-buggyfill"!==name){var value=fakeRule[1].trim();if(declarations.push([rule,name,value]),calcExpression.test(value)){var webkitValue=value.replace(calcExpression,"-webkit-calc(");declarations.push([rule,name,webkitValue])}}}})}}return{required:function(options){return options.isMobileSafari||isOldInternetExplorer},initialize:function(initOptions){options=initOptions;var div=document.createElement("div");div.style.width="1vmax",supportsVminmax=""!==div.style.width,(options.isMobileSafari||options.isBadStockAndroid)&&(supportsVminmaxCalc=!1)},initializeEvents:function(options,refresh,_refresh){options.force||isOldInternetExplorer&&!options._listeningToResize&&(window.addEventListener("resize",_refresh,!0),options._listeningToResize=!0)},findDeclarations:function(declarations,rule,name,value){null!==name&&checkHacks(declarations,rule,name,value)},overwriteDeclaration:function(rule,name,_value){return isOldInternetExplorer&&"filter"===name&&(_value=_value.replace(/px/g,"")),_value}}}),function(root,factory){"use strict";"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?module.exports=factory():root.viewportUnitsBuggyfill=factory()}(this,function(){"use strict";var options,dimensions,declarations,styleNode,initialized=!1,userAgent=window.navigator.userAgent,viewportUnitExpression=/([+-]?[0-9.]+)(vh|vw|vmin|vmax)/g,forEach=[].forEach,isOldInternetExplorer=!1,isOperaMini=userAgent.indexOf("Opera Mini")>-1,isMobileSafari=/(iPhone|iPod|iPad).+AppleWebKit/i.test(userAgent)&&function(){var iOSversion=userAgent.match(/OS (\d)/);return iOSversion&&iOSversion.length>1&&parseInt(iOSversion[1])<8}(),isBadStockAndroid=function(){var isAndroid=userAgent.indexOf(" Android ")>-1;if(!isAndroid)return!1;var isStockAndroid=userAgent.indexOf("Version/")>-1;if(!isStockAndroid)return!1;var versionNumber=parseFloat((userAgent.match("Android ([0-9.]+)")||[])[1]);return 4.4>=versionNumber}();isOldInternetExplorer||(isOldInternetExplorer=!!navigator.userAgent.match(/Trident.*rv[ :]*11\./));function debounce(func,wait){var timeout;return function(){var context=this,args=arguments,callback=function(){func.apply(context,args)};clearTimeout(timeout),timeout=setTimeout(callback,wait)}}function inIframe(){try{return window.self!==window.top}catch(e){return!0}}function initialize(initOptions){initialized||(initOptions===!0&&(initOptions={force:!0}),options=initOptions||{},options.isMobileSafari=isMobileSafari,options.isBadStockAndroid=isBadStockAndroid,(options.force||isMobileSafari||isOldInternetExplorer||isBadStockAndroid||isOperaMini||options.hacks&&options.hacks.required(options))&&(options.hacks&&options.hacks.initialize(options),initialized=!0,styleNode=document.createElement("style"),styleNode.id="patched-viewport",document.head.appendChild(styleNode),importCrossOriginLinks(function(){var _refresh=debounce(refresh,options.refreshDebounceWait||100);window.addEventListener("orientationchange",_refresh,!0),window.addEventListener("pageshow",_refresh,!0),(options.force||isOldInternetExplorer||inIframe())&&(window.addEventListener("resize",_refresh,!0),options._listeningToResize=!0),options.hacks&&options.hacks.initializeEvents(options,refresh,_refresh),refresh()})))}function updateStyles(){styleNode.textContent=getReplacedViewportUnits(),styleNode.parentNode.appendChild(styleNode)}function refresh(){initialized&&(findProperties(),setTimeout(function(){updateStyles()},1))}function findProperties(){return declarations=[],forEach.call(document.styleSheets,function(sheet){"patched-viewport"!==sheet.ownerNode.id&&sheet.cssRules&&"ignore"!==sheet.ownerNode.getAttribute("data-viewport-units-buggyfill")&&(sheet.media&&sheet.media.mediaText&&window.matchMedia&&!window.matchMedia(sheet.media.mediaText).matches||forEach.call(sheet.cssRules,findDeclarations))}),declarations}function findDeclarations(rule){if(7===rule.type){var value;try{value=rule.cssText}catch(e){return}return viewportUnitExpression.lastIndex=0,void(viewportUnitExpression.test(value)&&(declarations.push([rule,null,value]),options.hacks&&options.hacks.findDeclarations(declarations,rule,null,value)))}if(!rule.style){if(!rule.cssRules)return;return void forEach.call(rule.cssRules,function(_rule){findDeclarations(_rule)})}forEach.call(rule.style,function(name){var value=rule.style.getPropertyValue(name);rule.style.getPropertyPriority(name)&&(value+=" !important"),viewportUnitExpression.lastIndex=0,viewportUnitExpression.test(value)&&(declarations.push([rule,name,value]),options.hacks&&options.hacks.findDeclarations(declarations,rule,name,value))})}function getReplacedViewportUnits(){dimensions=getViewport();var open,close,css=[],buffer=[];return declarations.forEach(function(item){var _item=overwriteDeclaration.apply(null,item),_open=_item.selector.length?_item.selector.join(" {\n")+" {\n":"",_close=new Array(_item.selector.length+1).join("\n}");return _open&&_open===open?(_open&&!open&&(open=_open,close=_close),void buffer.push(_item.content)):(buffer.length&&(css.push(open+buffer.join("\n")+close),buffer.length=0),void(_open?(open=_open,close=_close,buffer.push(_item.content)):(css.push(_item.content),open=null,close=null)))}),buffer.length&&css.push(open+buffer.join("\n")+close),isOperaMini&&css.push("* { content: normal !important; }"),css.join("\n\n")}function overwriteDeclaration(rule,name,value){var _value,_selectors=[];_value=value.replace(viewportUnitExpression,replaceValues),options.hacks&&(_value=options.hacks.overwriteDeclaration(rule,name,_value)),name&&(_selectors.push(rule.selectorText),_value=name+": "+_value+";");for(var _rule=rule.parentRule;_rule;)_selectors.unshift("@media "+_rule.media.mediaText),_rule=_rule.parentRule;return{selector:_selectors,content:_value}}function replaceValues(match,number,unit){var _base=dimensions[unit],_number=parseFloat(number)/100;return _number*_base+"px"}function getViewport(){var vh=window.innerHeight,vw=window.innerWidth;return{vh:vh,vw:vw,vmax:Math.max(vw,vh),vmin:Math.min(vw,vh)}}function importCrossOriginLinks(next){var _waiting=0,decrease=function(){_waiting--,_waiting||next()};forEach.call(document.styleSheets,function(sheet){sheet.href&&origin(sheet.href)!==origin(location.href)&&(_waiting++,convertLinkToStyle(sheet.ownerNode,decrease))}),_waiting||next()}function origin(url){return url.slice(0,url.indexOf("/",url.indexOf("://")+3))}function convertLinkToStyle(link,next){getCors(link.href,function(){var style=document.createElement("style");style.media=link.media,style.setAttribute("data-href",link.href),style.textContent=this.responseText,link.parentNode.replaceChild(style,link),next()},next)}function getCors(url,success,error){var xhr=new XMLHttpRequest;if("withCredentials"in xhr)xhr.open("GET",url,!0);else{if("undefined"==typeof XDomainRequest)throw new Error("cross-domain XHR not supported");xhr=new XDomainRequest,xhr.open("GET",url)}return xhr.onload=success,xhr.onerror=error,xhr.send(),xhr}return{version:"0.5.1",findProperties:findProperties,getCss:getReplacedViewportUnits,init:initialize,refresh:refresh}}),window.viewportUnitsBuggyfill.init({refreshDebounceWait:50,hacks:window.viewportUnitsBuggyfillHacks});